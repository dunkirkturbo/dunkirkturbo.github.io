<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Research on aBFT | 0xDktb's Blog</title><meta name="description" content="Overview  https:&#x2F;&#x2F;medium.com&#x2F;@crytpol_25852&#x2F;asynchronous-byzantine-fault-tolerance-a-time-independent-future-proof-byzantine-fault-f6f1a4d1f17a Nonetheless, all these protocols employ at their core"><meta name="author" content="0xDktb"><meta name="copyright" content="0xDktb"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://0xdktb.top/2021/12/06/Research-on-aBFT/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Research on aBFT"><meta property="og:url" content="https://0xdktb.top/2021/12/06/Research-on-aBFT/"><meta property="og:site_name" content="0xDktb's Blog"><meta property="og:description" content="Overview  https:&#x2F;&#x2F;medium.com&#x2F;@crytpol_25852&#x2F;asynchronous-byzantine-fault-tolerance-a-time-independent-future-proof-byzantine-fault-f6f1a4d1f17a Nonetheless, all these protocols employ at their core"><meta property="og:image" content="https://0xdktb.top/img/star.jpg"><meta property="article:published_time" content="2021-12-05T19:02:50.000Z"><meta property="article:modified_time" content="2021-12-14T12:26:06.257Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="Engineering Practice of Cryptosystem(2)" href="https://0xdktb.top/2022/07/20/Engineering-Practice-of-Cryptosystem-2/"><link rel="next" title="Survey of Blockchain consensus algorithm" href="https://0xdktb.top/2021/11/12/Survey-of-Blockchain-consensus-algorithm/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">35</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#overview"><span class="toc-number">1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#honey-badger-bft"><span class="toc-number">2.</span> <span class="toc-text">Honey Badger BFT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#main-procedure"><span class="toc-number">2.1.</span> <span class="toc-text">Main Procedure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#acs-asynchronous-common-subset"><span class="toc-number">2.2.</span> <span class="toc-text">ACS (Asynchronous Common Subset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rbc-reliable-broadcast"><span class="toc-number">2.3.</span> <span class="toc-text">RBC (Reliable Broadcast)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aba-asynchronous-binary-agreement"><span class="toc-number">2.4.</span> <span class="toc-text">ABA (Asynchronous Binary Agreement)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reference"><span class="toc-number">2.5.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashgraph"><span class="toc-number">3.</span> <span class="toc-text">Hashgraph</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#reference-1"><span class="toc-number">3.1.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dumbo-bft"><span class="toc-number">4.</span> <span class="toc-text">Dumbo BFT</span></a></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(/img/star.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">0xDktb's Blog</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Research on aBFT</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2021-12-06 03:02:50"><i class="far fa-calendar-alt fa-fw"></i> Created 2021-12-06</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2021-12-14 20:26:06"><i class="fas fa-history fa-fw"></i> Updated 2021-12-14</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Blockchain/">Blockchain</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h3 id="overview">Overview</h3>
<blockquote>
<p>https://medium.com/<span class="citation" data-cites="crytpol_25852/asynchronous-byzantine-fault-tolerance-a-time-independent-future-proof-byzantine-fault-f6f1a4d1f17a">@crytpol_25852/asynchronous-byzantine-fault-tolerance-a-time-independent-future-proof-byzantine-fault-f6f1a4d1f17a</span></p>
<p>Nonetheless, all these protocols employ at their core a synchronous (or partially/weak synchronous) BFT consensus algorithm which makes them unsuitable for TRULY permissionless blockchain settings where “network links can be unreliable, network speeds change rapidly, and network delays may even be adversarially induced” ¹⁷. All these BFT variants might be prepared to tolerate malfunction faults due to adversarial collusion or damage in the nodes according to the classical definition of a byzantine attack but the internet has taught us that byzantine behavior can evolve beyond to what a legacy understanding of what is a byzantine attack could have predicted. For instance, Botnetsd¹⁸ and Distributed Denial of Service (DDoS) attacks can easily be used to flood with packets an important node involved heavily in consensus and thus delaying the transmission of packets said node must send/receive for the network to achieve consensus, leading to the halting of the entire network. In this scenario is evident that synchronous consensus algorithms are susceptible to time-delayed attack due to the fact that the transmission of messages needed to achieve consensus are time-bounded. Therefore, synchronous BFT consensus algorithms are not the strongest form BFT because time-assumption are made which makes provably impossible to guarantee liveness in adversarial settings where time-based attacks are constant as can certainly happen when we use the internet¹⁹.</p>
</blockquote>
<p>BFT protocols which can run in <em>asynchronous</em> networks are particularly robust against attacks that can be mounted over public networks. Such asynchronous BFT (<strong>aBFT</strong>) protocols ensure that transactions are processed without timing assumptions.</p>
<p><strong>异步（Asynchronous）</strong>环境下只保证消息最终能够到达，但没有对于到达时间的限制。aBFT在设计上需要保证共识系统不会丧失活性。</p>
<h3 id="honey-badger-bft">Honey Badger BFT</h3>
<p>核心模块→异步共同子集协议（Asynchronous Common Subset, ACS），且HB-BFT将ACS协议分割为两个子模块：</p>
<p>在第一阶段，每个节点使用RBC协议（Reliable Broadcast）将本地的proposal广播给其他节点；在第二阶段，每个节点都并行执行n个ABA协议（Asynchronous Binary Agreement），来共识一个<strong>位向量</strong>（用于表示哪些RBC已成功）</p>
<p>门限加密模块↓</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/Snipaste_2021-12-03_18-02-44.png"></p>
<h4 id="main-procedure">Main Procedure</h4>
<p>完整的Honey Badger BFT流程如下：</p>
<ol type="1">
<li>每个节点从本地交易池（buf）中随机选取<span class="math inline">\(\lfloor B/N\rfloor\)</span>个交易，作为<span class="math inline">\(proposed\)</span>。并使用门限加密模块Setup后的共享公钥<span class="math inline">\(PK\)</span>对<span class="math inline">\(proposed\)</span>进行加密→<span class="math inline">\(x\)</span>；</li>
<li>每个节点都并行执行<span class="math inline">\(\{RBC_i\}_N,\{ABA_i\}_N\)</span>，组成ACS模块。将<span class="math inline">\(x\)</span>作为各自ACS模块的输入（实际上对于节点<span class="math inline">\(\mathcal{P}_j\)</span>，即作为本地<span class="math inline">\(RBC_j\)</span>的输入，见Figure_4），得到系统共识“YES”后的<em>enc_proposed</em>集合；</li>
<li>对Step 2输出的<em>enc_proposed</em>集合进行遍历处理：广播自己的秘密份额<span class="math inline">\(e_j\)</span>，并通过f+1份share message解密得到明文交易集；</li>
<li>排序交易集，写入区块（但官方论文中的e.g. lexicographically有点迷惑哈...区块交易可以这么定序的嘛❓）</li>
<li>从本地交易池中remove已确认交易；</li>
</ol>
<figure>
<img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/53841f31b5ed66280d2b3adc62ef9db5_5_Figure_1.png" alt="Figure_1"><figcaption aria-hidden="true">Figure_1</figcaption>
</figure>
<h4 id="acs-asynchronous-common-subset">ACS (Asynchronous Common Subset)</h4>
<p>Ben-Or等人设计了下述协议，来达成容量至少为<span class="math inline">\(N-f\)</span>的子集共识。（<span class="math inline">\(N-f\)</span>为最大容错下的诚实节点数）</p>
<p>for party <span class="math inline">\(\mathcal{P}_i\)</span>：</p>
<ol type="1">
<li><p>本地输入，作为<span class="math inline">\(RBC_i\)</span>的输入；</p></li>
<li><p><span class="math inline">\(RBC_j\)</span>执行成功，将<span class="math inline">\(ABA_j\)</span>的输入置1；</p></li>
<li><p>至少<strong><span class="math inline">\(N-f\)</span>个<span class="math inline">\(ABA\)</span>实例</strong>执行完成时，将其他<span class="math inline">\(ABA\)</span>实例输入均置0；</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/Snipaste_2021-12-04_13-58-02.png"></p>
<p>上图为官方论文的解释，由此对登链社区<a href="https://learnblockchain.cn/article/2494#ACS--Asynchronous-Common-Subset-" target="_blank" rel="noopener">https://learnblockchain.cn/article/2494#ACS--Asynchronous-Common-Subset-</a>一文中该点相关的描述作出勘误：</p>
<p>若在<span class="math inline">\(N-f\)</span>个<span class="math inline">\(RBC\)</span>实例成功后就将其他<span class="math inline">\(ABA\)</span>输入置0，将可能出现以下情况：</p>
<p>  在诚实节点<span class="math inline">\(\mathcal{P}_i\)</span>上，有诚实节点<span class="math inline">\(\mathcal{P}_j\)</span>对应的<span class="math inline">\(RBC_{j}\)</span>还未执行成功，但已有其他<span class="math inline">\(N-f\)</span>个诚实节点对应的<span class="math inline">\(RBC\)</span>执行成功➡<span class="math inline">\(ABA_j\)</span>的输入置0；</p>
<p>  假如存在若干诚实节点本地运行的<span class="math inline">\(RBC_j\)</span>出现上述<span class="math inline">\(\mathcal{P}_i\)</span>的情况，导致<span class="math inline">\(ABA_j\)</span>的共识过程收不到<span class="math inline">\(N-f\)</span>条<span class="math inline">\(Aux(1)\)</span>➡<span class="math inline">\(ABA_j\)</span>的输出为0（<strong>本应该为1</strong>）；</p>
<p>  <strong>由于每个诚实节点本地<span class="math inline">\(N-f\)</span>个<span class="math inline">\(RBC\)</span>实例执行成功的顺序可能不同</strong>，因此考虑最坏情况，可能出现论文中说的"the resulting bit vector could be <strong>empty</strong>"</p>
<p>回到Figure_4的实现，若改为在<span class="math inline">\(N-f\)</span>个<span class="math inline">\(ABA\)</span>实例成功（输出1）后，再将其余未开始执行的<span class="math inline">\(ABA\)</span>输入置0，则<strong>至少能保证<span class="math inline">\(size(resulting\ bit\ vector)\)</span>为<span class="math inline">\(N-f\)</span></strong>。且如果不考虑最坏情况（即某个诚实节点对应的<span class="math inline">\(RBC\)</span>在很多节点上直到<span class="math inline">\(N-f\)</span>个<span class="math inline">\(ABA\)</span>均已输出1还未执行成功），则延迟较大的情况下将出现下述情况（仍能output 1）：</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/Snipaste_2021-12-04_15-44-28.png"></p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/Snipaste_2021-12-04_15-56-51.png"></p></li>
<li><p>当所有<span class="math inline">\(ABA\)</span>实例执行完成后，输出为1的<span class="math inline">\(ABA\)</span>下标映射到最终的<em>enc_proposed</em>集合；</p></li>
</ol>
<figure>
<img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/53841f31b5ed66280d2b3adc62ef9db5_7_Figure_4.png" alt="Figure_4"><figcaption aria-hidden="true">Figure_4</figcaption>
</figure>
<h4 id="rbc-reliable-broadcast">RBC (Reliable Broadcast)</h4>
<p>RBC协议可保证将消息可靠地发送至网络中的所有节点。</p>
<p>Honey Badger BFT中的RBC协议设计如下：</p>
<ol type="1">
<li><p>本地输入，基于<span class="math inline">\((N-2f,N)\)</span>纠删码进行分割，并计算N份叶节点<span class="math inline">\(\{s_j\}_N\)</span>对应的Merkle Root <span class="math inline">\(h\)</span>，向节点<span class="math inline">\(\mathcal{P}_j\)</span>发送<span class="math inline">\(VAL(h,b_j,s_j)\)</span></p>
<p>其中<span class="math inline">\(VAL\)</span>是消息类型名，<span class="math inline">\(b_j\)</span>为Merkle Tree从根到<span class="math inline">\(s_j\)</span>的对应分支，示例如下：</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/0_EBENZgjKN5XMEJ8m.png" style="zoom:33%;"></p>
<blockquote>
<p>If we would receive the block <em>L4,</em> we would only need <em>Hash 1–0</em> and <em>Hash 0</em> to verify that block <em>L4</em> is valid for the root hash.</p>
</blockquote></li>
<li><p>收到<span class="math inline">\(VAL\)</span>包后广播对应<span class="math inline">\(ECHO\)</span>包；</p></li>
<li><p>收到<span class="math inline">\(ECHO\)</span>包后校验Merkle Tree的分支，不合法则丢弃；</p></li>
<li><p>当收集满<span class="math inline">\(N-f\)</span>（i.e. <span class="math inline">\(2f+1\)</span>）个合法<span class="math inline">\(ECHO\)</span>包后，从任意<span class="math inline">\(f+1\)</span>个恢复出完整的<span class="math inline">\(N\)</span>个叶节点<span class="math inline">\(\{s_j^{&#39;}\}\)</span>，并验证Merkle Root是否一致，若一致则广播<span class="math inline">\(READY\)</span>包；</p>
<p><strong>Q: 为什么纠删码采用<span class="math inline">\(f+1\)</span>（i.e. <span class="math inline">\(N-2f\)</span>），论文中暂未找到说明</strong></p></li>
<li><p>对于<strong>延迟较大</strong>的节点，若在收到<span class="math inline">\(N-f\)</span>个合法<span class="math inline">\(ECHO\)</span>包前，先收到了<span class="math inline">\(f+1\)</span>个<span class="math inline">\(READY\)</span>包，则说明至少由一个诚实节点发出，将同样广播<span class="math inline">\(READY\)</span>包；</p></li>
<li><p>等待收到<span class="math inline">\(2f+1\)</span>个<span class="math inline">\(READY\)</span>包，若已收到<span class="math inline">\(N-2f\)</span>个合法<span class="math inline">\(ECHO\)</span>包，则恢复出对应完整输入，否则继续等待足够的<span class="math inline">\(ECHO\)</span>包；</p></li>
</ol>
<figure>
<img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/53841f31b5ed66280d2b3adc62ef9db5_6_Figure_2.png" alt="Figure_2"><figcaption aria-hidden="true">Figure_2</figcaption>
</figure>
<h4 id="aba-asynchronous-binary-agreement">ABA (Asynchronous Binary Agreement)</h4>
<p><span class="math inline">\(ABA\)</span>协议（如图示）对<strong>单个bit</strong>作出共识（r means the round number）</p>
<p>HB-BFT使用的ABA协议参考自</p>
<blockquote>
<p>A. Mostefaoui, H. Moumen, and M. Raynal. Signature-free asynchronous byzantine consensus with t&lt; n/3 and o (n 2) messages. In Proceedings of the 2014 ACM symposium on Principles of distributed computing, pages 2–9. ACM, 2014.</p>
</blockquote>
<p>初始化<span class="math inline">\(est_{0}\)</span>为该<span class="math inline">\(ABA\)</span>实例的输入，进入下面的循环：</p>
<ol type="1">
<li><p>广播<span class="math inline">\(BVAL_{r}(est_r)\)</span>；</p>
<p><span class="math inline">\(BVAL\)</span> probably means BIT_VALUE</p></li>
<li><p>令<span class="math inline">\(bin\_values_r\)</span>为空集；</p></li>
<li><p>当收到来自<span class="math inline">\(f+1\)</span>个节点的<span class="math inline">\(BVAL_r(b)\)</span>时，证明至少由一个诚实节点发出，若未发送过<span class="math inline">\(BVAL_r(b)\)</span>，则广播该消息；</p></li>
<li><p>当收到来自<span class="math inline">\(2f+1\)</span>个节点的<span class="math inline">\(BVAL_r(b)\)</span>时，将<span class="math inline">\(b\)</span>加入集合<span class="math inline">\(bin\_values_r\)</span>；</p></li>
<li><p>当<span class="math inline">\(bin\_values_r\)</span>不为空集时：</p>
<ul>
<li><p>广播<span class="math inline">\(AUX_r(w)\)</span>，<span class="math inline">\(w\in bin\_values_r\)</span>；</p></li>
<li><p>等待，直到收到<span class="math inline">\(n-f\)</span>(i.e. <span class="math inline">\(2f+1\)</span>)条<span class="math inline">\(AUX_r\)</span>消息（其中包含的值构成集合<span class="math inline">\(vals\)</span>），需要满足<span class="math inline">\(vals\sub bin\_values_r\)</span>；</p></li>
</ul>
<p>注意(5)在监听等待时，(3)(4)仍在运行，因此<span class="math inline">\(bin\_values_r\)</span>可能变化（存在部分<span class="math inline">\(AUX_r\)</span>消息携带的值满足<span class="math inline">\(\in bin\_values_r\)</span>，被加入计数）⬅ 解释了原文为何说"this condition may be triggered upon arrival of either an AUX or an BVAL"；</p>
<p>但(5)不会随着<span class="math inline">\(bin\_values_r\)</span>的变化再次广播 ⬅ 每个诚实节点只会选择一个<span class="math inline">\(w\)</span>，广播<span class="math inline">\(AUX_r(w)\)</span>；</p>
<ul>
<li><p>获取随机源s（见Figure_12）</p></li>
<li><p>若<span class="math inline">\(\mid vals\mid=2\)</span>，令下一轮的<span class="math inline">\(est_{r+1}=s\)</span>；</p>
<p>若<span class="math inline">\(\mid vals\mid=1,vals=\{v\}\)</span>，令<span class="math inline">\(est_{r+1}=v\)</span>，若<span class="math inline">\(v=s\%2\)</span>，输出<span class="math inline">\(v\)</span>，否则继续循环；</p></li>
</ul></li>
</ol>
<figure>
<img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/53841f31b5ed66280d2b3adc62ef9db5_14_Figure_11.png" alt="Figure_11"><figcaption aria-hidden="true">Figure_11</figcaption>
</figure>
<p>ABA的正确性证明可以移步<a href="https://zhuanlan.zhihu.com/p/46274211" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/46274211</a></p>
<p>PBFT等弱同步共识算法中若无法收到相同VOTE的<span class="math inline">\(2f+1\)</span>条信息（假设<span class="math inline">\(f\)</span>个拜占庭节点均不发消息，而<span class="math inline">\(2f+1\)</span>个诚实节点间存在不一致VOTE👈下面解释），则引入定时器timer来解决无法达成共识的问题；</p>
<p>这里解释一下为什么存在诚实节点分歧👉e.g. PBFT中leader本身作恶，发给一部分节点能通过校验的区块，而发给另一部分节点不能通过校验的区块</p>
<p>而Honey Badger BFT异步共识算法不存在timer，并引入了随机源来解决上述问题，使得共识不会停滞（失去活性）；</p>
<p>HB-BFT中随机源采用的方案是对Coins' sid的(n, f+1)阈值签名（➡ f个拜占庭节点不可能得到合法签名）；</p>
<figure>
<img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/53841f31b5ed66280d2b3adc62ef9db5_14_Figure_12.png" alt="Figure_12"><figcaption aria-hidden="true">Figure_12</figcaption>
</figure>
<h4 id="reference">Reference</h4>
<ul>
<li>The Honey Badger of BFT Protocols (paper)</li>
<li>Signature-Free Asynchronous Byzantine Consensus with t &lt; n/3 and O(n 2 ) Messages (paper)</li>
<li><a href="https://learnblockchain.cn/article/2494#RBC--Reliable-Broadcast-" target="_blank" rel="noopener">https://learnblockchain.cn/article/2494#RBC--Reliable-Broadcast-</a></li>
</ul>
<h3 id="hashgraph">Hashgraph</h3>
<blockquote>
<p>Hashgraph - a data structure that records who gossiped to whom, and in what order.</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/8b92a19756c541467b3e9ee656a742e3_4_Figure_1.png"></p>
<ul>
<li><p>Hashgraph基础数据单元为event（包含TransactionSet、Timestamp和两个父event的HashValue）</p></li>
<li><p>Hashgraph网络下使用gossip协议进行通信，每个节点不停随机选择其他节点sync<strong>"己方已知但对方未知"</strong>的events，receiver收到sync后则创建自己的最新event（父hash分别指向<code>self-parent</code>和sender的最新event），并同样向随机节点sync</p>
<p>因此实际上传输的是<em>hashgraph itself</em>，即gossip about gossip协议：</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/Snipaste_2021-12-13_15-27-51.jpg"></p></li>
<li><p>Hashgraph将event按round划分，首先引入前置概念：</p>
<ul>
<li>See: 如果event w存在到event x的通路（有向边），则称w see x</li>
<li>Strongly see: 如果网络节点总数为n，event w可见超过2n/3个<strong>不同</strong>节点的event（且这些event均可见event x），则称w strongly see x</li>
</ul>
<p>对于Hashgraph下的节点，每一round中其创建的第一个event被记作<strong>witness</strong>（见证人）</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/image-20211214170712208.png"></p>
<p>每一个event都存在对应的<strong>round created number</strong>：</p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/8b92a19756c541467b3e9ee656a742e3_8_Figure_3.png"></p>
<p><img src= "/img/loading.gif" data-src="/2021/12/06/Research-on-aBFT/image-20211214171338852.png"></p>
<p>若event w的父event中最大round为r，则其round created number相应的为r或r+1（<strong>r+1当且仅当w能strongly see超过2n/3个不同节点下round r的witness</strong>➡成为新一轮witness）</p></li>
<li></li>
</ul>
<h4 id="reference-1">Reference</h4>
<ul>
<li>THE SWIRLDS HASHGRAPH CONSENSUS ALGORITHM: FAIR, FAST, BYZANTINE FAULT TOLERANCE (paper)</li>
</ul>
<h3 id="dumbo-bft">Dumbo BFT</h3>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">0xDktb</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://0xdktb.top/2021/12/06/Research-on-aBFT/">https://0xdktb.top/2021/12/06/Research-on-aBFT/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/star.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wx.jpg" alt="wechat" onclick="window.open('/img/wx.jpg')"/><div class="post-qr-code__desc">wechat</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/zfb.jpg" alt="alipay" onclick="window.open('/img/zfb.jpg')"/><div class="post-qr-code__desc">alipay</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/07/20/Engineering-Practice-of-Cryptosystem-2/"><img class="prev-cover" data-src="/img/star.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Engineering Practice of Cryptosystem(2)</div></div></a></div><div class="next-post pull-right"><a href="/2021/11/12/Survey-of-Blockchain-consensus-algorithm/"><img class="next-cover" data-src="/img/star.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Survey of Blockchain consensus algorithm</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(/img/star.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By 0xDktb</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>湘ICP备19022012号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button></div><div id="rightside-config-show"><button id="rightside_config" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>